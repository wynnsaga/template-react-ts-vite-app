---
title: "åœ¨ Vue ä¸­ä½¿ç”¨ CodeMirror"
image: "https://frame-illust.com/fi/wp-content/uploads/2015/05/37578bf4abf81e038bdd8b93b203456b-150x150.gif"
date: 2024-02-20
categories: ["Vueæ‰©å±•"]
tags: ["vue", "codemirror"]
draft: false
pin: false
---

CodeMirror æ˜¯ä¸€ç§éå¸¸å¼ºå¤§çš„ä»£ç ç¼–è¾‘å™¨ï¼Œå®ƒæä¾›äº†è®¸å¤šå¯¹äº Vue.js é¡¹ç›®çš„å¼€å‘éå¸¸æœ‰ç”¨çš„åŠŸèƒ½ã€‚å¦‚æœæ‚¨æ­£åœ¨æ„å»º Vue.js é¡¹ç›®å¹¶éœ€è¦ä¸€ä¸ªé«˜æ•ˆã€çµæ´»ä¸”æ˜“äºä½¿ç”¨çš„ä»£ç ç¼–è¾‘å™¨ï¼Œåˆ™ CodeMirror å¯èƒ½æ˜¯æ‚¨éœ€è¦çš„å·¥å…·ä¹‹ä¸€ã€‚æœ¬æ–‡å°†å‘æ‚¨ä»‹ç»ä½¿ç”¨ vue-codemirror ä¸º Vue.js é¡¹ç›®æ­å»ºä¸€ä¸ªä¼˜ç§€çš„ä»£ç ç¼–è¾‘ç¯å¢ƒï¼Œä»¥ä¾¿ä¸º Vue é¡¹ç›®æ‰“é€ å‡ºé«˜æ•ˆä¸”æ„‰æ‚¦çš„å¼€å‘ä½“éªŒã€‚è®©æˆ‘ä»¬ä¸€èµ·å¼€å§‹æ„å»ºä¸€ä¸ªå¼ºå¤§çš„ä»£ç ç¼–è¾‘ç¯å¢ƒå§ï¼

## å®‰è£…ä¾èµ–

CodeMirror æ˜¯ä¸€ä¸ªåŸºäº Web æŠ€æœ¯çš„å¼€æºä»£ç ç¼–è¾‘å™¨.

vue-codemirror æ˜¯ä¸€ä¸ªåŸºäº Vue.js çš„ä»£ç ç¼–è¾‘å™¨ç»„ä»¶ï¼Œå®ƒé›†æˆäº† CodeMirror ç¼–è¾‘å™¨å¹¶æä¾›äº† Vue.js ç»„ä»¶åŒ–çš„å°è£…

```bash
# ç›´æ¥å®‰è£…ä¼šå®‰è£…æœ€æ–°ç‰ˆæœ¬ï¼Œä»…æ”¯æŒ Vue3.0
npm i codemirror vue-codemirror --save

# Vue2.0 ä¸­éœ€è¦æŒ‡å®šå®‰è£… 4.x ç‰ˆæœ¬
npm i codemirror vue-codemirror@4.x --save
```

## å¯¼å…¥

### å…¨å±€å¯¼å…¥

```js
import Vue from "vue";
import App from "./App";

// å¯¼å…¥ä¸ç»„ä»¶æ³¨å†Œ
import { codemirror } from "vue-codemirror";
Vue.component("codemirror", codemirror);
```

### å±€éƒ¨å¯¼å…¥

```js
// å¯¼å…¥
import { codemirror } from "vue-codemirror";

export default {
    // ç»„ä»¶æ³¨å†Œ
    components: { codemirror },
};
```

## ä½¿ç”¨

### åŸºæœ¬åº”ç”¨

1. å¯¼å…¥æ ·å¼èµ„æº

```js
// ç¼–è¾‘å™¨æ‰€éœ€è¦çš„æ ·å¼æ–‡ä»¶
import "codemirror/lib/codemirror.css";

// è¯­è¨€æ¨¡å¼ï¼šæ ¹æ®ä¸åŒçš„ä»£ç è¯­è¨€å¼•å…¥ä¸åŒçš„js
// ä½ å¯ä»¥åˆ° node_modules/codemirror/mode/ ä¸‹å¯»æ‰¾éœ€è¦çš„æ–‡ä»¶
import "codemirror/mode/javascript/javascript";

// ä¸»é¢˜æ ·å¼ï¼šä»£ç å—çš„ä¸»é¢˜
// ä½ å¯ä»¥åˆ° node_modules/codemirror/theme/ ä¸‹å¯»æ‰¾éœ€è¦çš„æ–‡ä»¶
import "codemirror/theme/idea.css";

// é™„åŠ åŠŸèƒ½ï¼šæŸäº›é«˜çº§åŠŸèƒ½éœ€è¦å¼•å…¥é¢å¤–çš„ js æ–‡ä»¶
// ä½ å¯ä»¥åœ¨ node_modules/codemirror/addon ä¸‹æŸ¥æ‰¾
// ä»£ç æŠ˜å 
import "codemirror/addon/fold/foldgutter.css";
// æ¿€æ´»è¡Œé«˜äº®
import "codemirror/addon/selection/active-line.js";

// å…¶ä»–...
```

2. å‡†å¤‡ HTML å…ƒç´ å’Œæ•°æ®

```html
<!-- åŒå‘ç»‘å®š ä½¿ç”¨ v-model -->
<codemirror
    v-model="code"
    :options="cmOptions"></codemirror>

<!-- å•å‘ç»‘å®š ä½¿ç”¨ value , é€šè¿‡ input äº‹ä»¶è·å–è¾“å…¥çš„å†…å®¹ -->
<codemirror
    :value="code"
    :options="cmOptions"
    @input="onCmCodeChange">
</codemirror>
```

3. é…ç½®é¡¹

```js
data() {
    return {
        code: "",
        cmOptions: {
            // è¯­è¨€æ¨¡å¼
            mode: "javascript",
            // ä¸»é¢˜
            theme: "idea",
            // æ˜¾ç¤ºè¡Œå·
            lineNumbers: true,
            // è‡ªåŠ¨ç¼©è¿›
            smartIndent: true,
            // è‡ªåŠ¨åŒ¹é…æ‹¬å·
            matchBrackets: true,
            // è‡ªåŠ¨åŒ¹é…å¼•å·
            matchTags: true,
            // ä»£ç æŠ˜å 
            lineWrapping: true,
            // æ¿€æ´»è¡Œé«˜äº®
            styleActiveLine: true,
        },
    };
},

methods: {
    onCmCodeChange(newCode) {
        this.code = newCode;
    },
},
```

### èµ„æºä»‹ç»

å…³äºé…ç½®é¡¹çš„ä¸€äº›å¸¸ç”¨æ€»ç»“ï¼š

| åˆ†ç±»  | ä»£ç              | è¯´æ˜       |
| :---- | :--------------- | :--------- |
| mode  | text/javascript  | JavaScript |
|       | text/html        | HTML       |
|       | text/css         | CSS        |
|       | application/xml  | XML        |
|       | application/json | JSON       |
|       | text/x-python    | Python     |
|       | text/x-java      | Java       |
|       | text/x-ruby      | Ruby       |
|       | text/x-c++src    | C++        |
|       | text/x-csharp    | C#         |
| theme | cobalt           | cobalt     |
|       | dracula          | dracula    |
|       | monokai          | monokai    |
|       | idea             | idea       |

## å°è£…ä¸€ä¸ªç»„ä»¶

ä¸‹é¢æ˜¯ä¸€ä¸ªå°è£…å¥½çš„ç»„ä»¶ï¼Œæ‹¿å»ç”¨å§ ğŸ‰ ï¼

```html
<template>
    <div>
        <codemirror
            ref="cm"
            :value="codestr"
            :options="cmOptions"
            @input="onCmCodeChange">
        </codemirror>
    </div>
</template>

<script>
    import { codemirror } from 'vue-codemirror'
    import 'codemirror/lib/codemirror.css'

    import "codemirror/mode/javascript/javascript"
    import 'codemirror/theme/idea.css'

    import 'codemirror/addon/fold/foldgutter.css"
    import "codemirror/addon/selection/active-line.js"

    export default {
    Â  Â  name: "CodeBlock",
    Â  Â  components: {
    Â  Â  Â  Â  codemirror
    Â  Â  },
    Â  Â  props: {
    Â  Â  Â  Â  codestr: {
    Â  Â  Â  Â  Â  Â  type: String,
    Â  Â  Â  Â  Â  Â  default: ""
    Â  Â  Â  Â  },
    Â  Â  Â  Â  codemode: {
    Â  Â  Â  Â  Â  Â  type: String,
    Â  Â  Â  Â  Â  Â  default: "json",
    Â  Â  Â  Â  Â  Â  validator: function (value) {
    Â  Â  Â  Â  Â  Â  Â  Â  return ['application/json'].includes(value);
    Â  Â  Â  Â  Â  Â  }

    Â  Â  Â  Â  },
    Â  Â  Â  Â  codetheme: {
    Â  Â  Â  Â  Â  Â  type: String,
    Â  Â  Â  Â  Â  Â  default: "idea",
    Â  Â  Â  Â  Â  Â  validator: function (value) {
    Â  Â  Â  Â  Â  Â  Â  Â  return ['idea'].includes(value);
    Â  Â  Â  Â  Â  Â  }
    Â  Â  Â  Â  }
    Â  Â  },
    Â  Â  mounted() {
    Â  Â  Â  Â  this.$refs.cm.codemirror.setSize("100%", 'auto');

    Â  Â  },
    Â  Â  computed: {
    Â  Â  Â  Â  cmOptions() {
    Â  Â  Â  Â  Â  Â  return {
    Â  Â  Â  Â  Â  Â  Â  Â  mode: this.codemode,
    Â  Â  Â  Â  Â  Â  Â  Â  theme: this.codetheme,

    Â  Â  Â  Â  Â  Â  Â  Â  // æ˜¯å¦æ˜¾ç¤ºè¡Œå·
    Â  Â  Â  Â  Â  Â  Â  Â  lineNumbers: true,
    Â  Â  Â  Â  Â  Â  Â  Â  // æ˜¯å¦è‡ªåŠ¨æ¢è¡Œ
    Â  Â  Â  Â  Â  Â  Â  Â  lineWrapping: true,

    Â  Â  Â  Â  Â  Â  Â  Â  // ä»£ç æŠ˜å 
    Â  Â  Â  Â  Â  Â  Â  Â  foldGutter: true,

    Â  Â  Â  Â  Â  Â  Â  Â  // æ²Ÿæ§½æ ·å¼ï¼Œä¼ å…¥æ•°ç»„ä¼šæŒ‰é¡ºåºä¾æ¬¡åº”ç”¨
    Â  Â  Â  Â  Â  Â  Â  Â  // å·¦ä¾§æ˜¯è¡Œå·ï¼Œè¡Œå·å³ä¾§æ˜¯æŠ˜å ç®­å¤´
    Â  Â  Â  Â  Â  Â  Â  Â  gutters: [
                        "CodeMirror-linenumbers",
                        "CodeMirror-foldgutter"
                    ],

    Â  Â  Â  Â  Â  Â  Â  Â  // é«˜äº®é€‰ä¸­çš„è¡Œ
    Â  Â  Â  Â  Â  Â  Â  Â  styleActiveLine: true,
    Â  Â  Â  Â  Â  Â  };
    Â  Â  Â  Â  }
    Â  Â  },

    Â  Â  data() {
    Â  Â  Â  Â  return {
    Â  Â  Â  Â  Â  Â  code: this.codestr
    Â  Â  Â  Â  }
    Â  Â  },

    Â  Â  methods: {
    Â  Â  Â  Â  getCurrentCode() {
    Â  Â  Â  Â  Â  Â  return this.code;
    Â  Â  Â  Â  },
    Â  Â  Â  Â  onCmCodeChange(newCode) {
    Â  Â  Â  Â  Â  Â  this.code = newCode;
    Â  Â  Â  Â  },
    Â  Â  },
    }
</script>
```
